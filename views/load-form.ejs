<!DOCTYPE html>
<html>
<head>
  <title>ðŸšœ Submit Load</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      background: url('/dt-bg.jpg') no-repeat center center fixed;
      background-size: cover;
      color: white;
    }

    .form-container {
      background: rgba(0, 0, 0, 0.8);
      padding: 30px;
      border-radius: 16px;
      max-width: 900px;
      margin: 40px auto;
    }

    h1, h3, label {
      color: #fff;
    }

    input, select {
      padding: 8px;
      margin: 5px 0;
      width: 100%;
      border-radius: 6px;
      border: none;
    }

    button {
      background-color: #2e7d32;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 10px 16px;
      margin-top: 10px;
      cursor: pointer;
    }

    button:hover {
      background-color: #1b5e20;
    }

    .logo {
      text-align: center;
      margin-top: 20px;
    }

    .logo img {
      height: 80px;
    }

    .section {
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <div class="logo">
    <img src="/dt-bg.png" alt="D&T Logo">
  </div>

  <div class="form-container">
    <h1>ðŸšœ Submit Load</h1>
    <h3>Total Gallons Today: <%= totalGallons %></h3>
    <h3>Total Fuel Used Today: <%= totalFuel %></h3>

    <% if (lastLoad) { %>
      <p><strong>Last Load:</strong> <%= new Date(lastLoad.timestamp).toLocaleString("en-US", { timeZone: "America/New_York", hour12: true }) %> by <%= lastLoad.tractor.name %></p>
    <% } %>

    <!-- Load Submission Form -->
    <form method="POST" action="/load">
      <div class="section">
        <label>Tractor</label>
        <select name="tractor" required>
          <% tractors.forEach(t => { %>
            <option value="<%= t._id %>" <%= selectedTractorId === t._id.toString() ? 'selected' : '' %>><%= t.name %></option>
          <% }) %>
        </select>

        <label>Farm</label>
        <select name="farm" required>
          <% farms.forEach(f => { %>
            <option value="<%= f._id %>" <%= selectedFarmId === f._id.toString() ? 'selected' : '' %>><%= f.name %></option>
          <% }) %>
        </select>

        <label>Field</label>
        <select name="field">
          <option value="">Optional</option>
          <% fields.forEach(field => { %>
            <option value="<%= field._id %>" <%= selectedFieldId === field._id.toString() ? 'selected' : '' %>><%= field.name %></option>
          <% }) %>
        </select>

        <label>Pit</label>
        <select name="pit">
          <option value="">Optional</option>
          <% pits.forEach(pit => { %>
            <option value="<%= pit._id %>"><%= pit.name %></option>
          <% }) %>
        </select>

        <label>Start Hour</label>
        <input type="text" name="startHour" placeholder="Ex: 6.5">

        <label>End Hour</label>
        <input type="text" name="endHour" placeholder="Ex: 14.25">

        <button type="submit">âœ… Submit Load</button>
      </div>
    </form>

    <!-- Fuel Submission Form -->
    <form method="POST" action="/load/submit-fuel" class="section">
      <h3>â›½ Submit Fuel Usage</h3>
      <label>Tractor</label>
      <select name="tractor" required>
        <% tractors.forEach(t => { %>
          <option value="<%= t._id %>"><%= t.name %></option>
        <% }) %>
      </select>

      <label>Field</label>
      <select name="field" required>
        <% fields.forEach(field => { %>
          <option value="<%= field._id %>"><%= field.name %></option>
        <% }) %>
      </select>

      <label>Gallons</label>
      <input type="number" name="amount" placeholder="Fuel amount" required step="0.1">

      <button type="submit">ðŸ’¾ Submit Fuel</button>
    </form>

    <!-- Tracked Start Hours -->
    <div class="section">
      <h3>âœ… Tracked Start Hours</h3>
      <% if (trackedHours && Object.keys(trackedHours).length > 0) { %>
        <ul>
          <% Object.entries(trackedHours).forEach(([key, hour]) => { %>
            <li><strong><%= key %></strong>: <%= hour %></li>
          <% }) %>
        </ul>
      <% } else { %>
        <p>No active start hours tracked.</p>
      <% } %>
    </div>
  </div>

</body>
</html>
