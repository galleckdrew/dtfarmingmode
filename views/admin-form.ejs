<!DOCTYPE html>
<html>
<head>
  <title>Admin Dropdown Editor</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f7f7f7; }
    h2 { border-bottom: 1px solid #ccc; padding-bottom: 5px; }
    .section { margin-bottom: 40px; background: white; padding: 20px; border-radius: 6px; box-shadow: 0 0 8px rgba(0,0,0,0.05); }
    ul { list-style: none; padding: 0; }
    li { margin-bottom: 8px; }
    form { display: inline-block; margin-left: 5px; }
    input[type="text"], input[type="number"] {
      padding: 5px;
      font-size: 14px;
    }
    button { padding: 5px 10px; font-size: 14px; }
  </style>
</head>
<body>
  <h1>‚öôÔ∏è Admin Panel ‚Äì Manage Dropdowns</h1>

  <% const sections = [
    { title: "Tractors", items: tractors, name: "tractor", gallonField: true },
    { title: "Farms", items: farms, name: "farm" },
    { title: "Fields", items: fields, name: "field" },
    { title: "Pits", items: pits, name: "pit" }
  ]; %>

  <% sections.forEach(section => { %>
    <div class="section">
      <h2><%= section.title %></h2>
      <ul>
        <% section.items.forEach(item => { %>
          <li>
            <form method="POST" action="/admin/<%= section.name %>s/<%= item._id %>?_method=PUT">
              <input type="text" name="name" value="<%= item.name %>" required>
              <% if (section.gallonField) { %>
                <input type="number" name="gallons" value="<%= item.gallons %>" placeholder="Gallons" required>
              <% } %>
              <button type="submit">Save</button>
            </form>
            <form method="POST" action="/admin/<%= section.name %>s/<%= item._id %>?_method=DELETE" onsubmit="return confirm('Are you sure?')">
              <button type="submit">Delete</button>
            </form>
          </li>
        <% }) %>
      </ul>

      <form method="POST" action="/admin/<%= section.name %>s">
        <input type="text" name="name" placeholder="New <%= section.title.slice(0, -1) %> Name" required>
        <% if (section.gallonField) { %>
          <input type="number" name="gallons" placeholder="Gallons" required>
        <% } %>
        <button type="submit">Add <%= section.title.slice(0, -1) %></button>
      </form>
    </div>
  <% }) %>

  <% if (trackedStartHours && Object.keys(trackedStartHours).length > 0) { %>
    <div class="section">
      <h2>üß† Tracked Start Hours</h2>
      <ul>
        <% Object.entries(trackedStartHours).forEach(([key, hour]) => { %>
          <li>
            <strong><%= key %></strong>: <%= hour %>
            <form method="POST" action="/admin/reset-tracking" style="display:inline">
              <input type="hidden" name="key" value="<%= key %>">
              <button type="submit">‚ùå Clear</button>
            </form>
          </li>
        <% }) %>
      </ul>
      <form method="POST" action="/admin/reset-all-tracking">
        <button>üö´ Clear All Tracked Hours</button>
      </form>
    </div>
  <% } else { %>
    <div class="section">
      <h2>üß† Tracked Start Hours</h2>
      <p>No active tracked start hours</p>
    </div>
  <% } %>

</body>
</html>
